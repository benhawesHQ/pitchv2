<!DOCTYPE html>
<html>
<head>
  <title>Pitch</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700;800&family=Open+Sans:wght@400;500;600&display=swap" rel="stylesheet">

  <style>

    :root {
      --orange: #f94501;
      --bg: #111111;
      --card: #1a1a1a;
      --soft: #2a2a2a;
    }

    body {
      margin: 0;
      background: var(--bg);
      color: white;
      font-family: 'Open Sans', sans-serif;
    }

    .hero {
      padding: 110px 20px 80px;
      text-align: center;
      border-bottom: 1px solid #222;
    }

    h1 {
      font-family: 'Poppins', sans-serif;
      font-weight: 800;
      font-size: 42px;
      margin-bottom: 14px;
    }

    .sub {
      font-size: 18px;
      opacity: 0.8;
      margin-bottom: 36px;
    }

    .search-box {
      max-width: 650px;
      margin: auto;
    }

    .field-group {
      margin-bottom: 18px;
    }

    label {
      display: block;
      font-size: 13px;
      opacity: 0.6;
      margin-bottom: 6px;
      text-align: left;
    }

    input, select, textarea {
      width: 100%;
      padding: 14px 16px;
      border-radius: 10px;
      border: 1px solid #2b2b2b;
      background: var(--card);
      color: white;
      font-size: 15px;
      font-family: 'Open Sans', sans-serif;
    }

    textarea {
      min-height: 90px;
      resize: vertical;
    }

    .toggle-row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 22px;
    }

    .toggle-btn {
      padding: 10px 14px;
      border-radius: 8px;
      background: var(--soft);
      cursor: pointer;
      font-size: 14px;
      border: 1px solid #333;
      transition: all 0.15s ease;
    }

    .toggle-btn.active {
      background: var(--orange);
      color: black;
      border-color: var(--orange);
      font-weight: 600;
    }

    .search-btn {
      width: 100%;
      padding: 16px;
      border-radius: 10px;
      border: none;
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
      font-size: 16px;
      background: var(--orange);
      color: black;
      cursor: pointer;
      transition: opacity 0.2s ease;
    }

    .search-btn:hover {
      opacity: 0.85;
    }

    #results {
      padding: 70px 20px;
      max-width: 900px;
      margin: auto;
    }

    .results-header {
      margin-bottom: 40px;
    }

    .results-header h2 {
      font-family: 'Poppins', sans-serif;
      font-size: 30px;
      margin-bottom: 6px;
    }

    .results-header p {
      opacity: 0.6;
      font-size: 14px;
    }

    .venue-card {
      background: var(--card);
      padding: 26px;
      border-radius: 14px;
      margin-bottom: 24px;
      border: 1px solid #222;
      transition: border 0.2s ease;
    }

    .venue-card:hover {
      border-color: var(--orange);
    }

    .venue-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .venue-title {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .venue-title h3 {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      font-size: 22px;
    }

    .likelihood {
      font-size: 13px;
      padding: 6px 12px;
      border-radius: 20px;
      background: var(--soft);
    }

    .venue-location {
      margin: 10px 0 6px;
      font-size: 14px;
      opacity: 0.6;
    }

    .venue-description {
      font-size: 15px;
      margin-bottom: 18px;
      opacity: 0.85;
    }

    .venue-actions a {
      display: inline-block;
      padding: 10px 16px;
      border-radius: 8px;
      background: var(--orange);
      color: black;
      font-weight: 600;
      text-decoration: none;
      font-size: 14px;
    }

    .footer {
      border-top: 1px solid #222;
      padding: 70px 20px;
      text-align: center;
    }

    .footer h3 {
      font-family: 'Poppins', sans-serif;
      font-size: 24px;
      margin-bottom: 16px;
    }

    .footer p {
      max-width: 600px;
      margin: auto;
      opacity: 0.75;
      line-height: 1.6;
    }

  </style>
</head>

<body>

  <div class="hero">
    <h1>Find venues. Book shows.</h1>
    <div class="sub">Built for independent artists serious about playing live.</div>

    <div class="search-box">

      <div class="field-group">
        <label>City</label>
        <input id="city" placeholder="Nashville, NYC, Chicago..." />
      </div>

      <div class="field-group">
        <label>Genre</label>
        <select id="genre">
          <option value="">Select genre</option>
          <option>Indie</option>
          <option>Rock</option>
          <option>Alternative</option>
          <option>Pop</option>
          <option>Jazz</option>
          <option>Cabaret</option>
          <option>Comedy</option>
        </select>
      </div>

      <div class="toggle-row">
        <div class="toggle-btn" id="likelyToggle">Likely to reply</div>
      </div>

      <div class="field-group">
        <label>What else matters?</label>
        <textarea id="extra" placeholder="150 cap rooms, queer-friendly, backline provided, etc."></textarea>
      </div>

      <button class="search-btn" onclick="searchVenues()">Search venues</button>

    </div>
  </div>

  <div id="results"></div>

  <div class="footer">
    <h3>How it works</h3>
    <p>
      You choose the city and the sound.
      We surface venues that regularly book emerging artists in that scene.
      You reach out directly.
      No middlemen. Just rooms that make sense for your next show.
    </p>
  </div>

<script>

let likelyActive = false;

document.getElementById("likelyToggle").addEventListener("click", function() {
  likelyActive = !likelyActive;
  this.classList.toggle("active");
});

async function searchVenues() {

  const city = document.getElementById("city").value;
  const genre = document.getElementById("genre").value;
  const extra = document.getElementById("extra").value;

  if (!city) {
    alert("Enter a city.");
    return;
  }

  const res = await fetch("/api/search", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ city, genre, likely: likelyActive, extra })
  });

  const data = await res.json();

  if (!res.ok) {
    document.getElementById("results").innerHTML = "<p>Error loading venues.</p>";
    return;
  }

  renderResults(data);
}

function renderResults(data) {

  const container = document.getElementById("results");

  container.innerHTML = `
    <div class="results-header">
      <h2>Venues in ${data.city}</h2>
      <p>Ranked by scene alignment and emerging artist friendliness.</p>
    </div>
  `;

  data.results.forEach(venue => {

    const card = document.createElement("div");
    card.className = "venue-card";

    card.innerHTML = `
      <div class="venue-header">
        <div class="venue-title">
          <span>${venue.emoji}</span>
          <h3>${venue.name}</h3>
        </div>
        <div class="likelihood">${venue.likelihood * 10}% match</div>
      </div>

      <div class="venue-location">${venue.neighborhood}, ${data.city}</div>
      <div class="venue-description">${venue.description}</div>

      <div class="venue-actions">
        <a href="https://www.google.com/search?q=${venue.name} ${data.city}" target="_blank">
          View venue info
        </a>
      </div>
    `;

    container.appendChild(card);
  });
}

</script>

</body>
</html>
