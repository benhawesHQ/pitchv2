<!DOCTYPE html>
<html>
<head>
  <title>Pitch.io | Book a show</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŽ¸</text></svg>">

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700;800&family=Open+Sans:wght@400;500;600&display=swap" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
:root{
  --orange:#f94501;
  --bg:#111;
  --card:#181818;
  --soft:#262626;
}

body{
  margin:0;
  background:var(--bg);
  color:white;
  font-family:'Open Sans',sans-serif;
}

/* HERO */

.hero{
  position:relative;
  background:url('https://images.unsplash.com/photo-1507874457470-272b3c8d8ee2?q=80&w=2070&auto=format&fit=crop') center/cover no-repeat;
  padding:140px 20px 100px;
  text-align:center;
}

.hero::after{
  content:"";
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.65);
}

.hero-content{
  position:relative;
  z-index:2;
  max-width:760px;
  margin:auto;
}

h1{
  font-family:'Poppins',sans-serif;
  font-weight:800;
  font-size:42px;
}

.sub{
  font-size:20px;
  margin-bottom:40px;
}

.search-box{
  background:rgba(20,20,20,.95);
  padding:32px;
  border-radius:14px;
  border:1px solid #222;
  text-align:left;
}

label{
  font-family:'Poppins';
  font-weight:700;
  font-size:14px;
  display:block;
  margin-bottom:8px;
}

input{
  width:100%;
  padding:14px;
  border-radius:8px;
  border:1px solid #333;
  background:var(--card);
  color:white;
  margin-bottom:24px;
}

.row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  margin-bottom:24px;
}

.pill{
  padding:8px 14px;
  border-radius:20px;
  background:var(--soft);
  border:1px solid #333;
  cursor:pointer;
}

.pill.active{
  background:var(--orange);
  color:black;
}

.segment{
  display:flex;
  background:var(--soft);
  border-radius:999px;
  padding:4px;
  margin-bottom:24px;
}

.segment-option{
  flex:1;
  text-align:center;
  padding:10px 0;
  border-radius:999px;
  cursor:pointer;
  font-family:'Poppins';
  font-weight:600;
}

.segment-option.active{
  background:var(--orange);
  color:black;
}

.search-btn{
  width:100%;
  padding:16px;
  border-radius:10px;
  border:none;
  font-family:'Poppins';
  font-weight:700;
  font-size:16px;
  background:var(--orange);
  color:black;
  cursor:pointer;
}

/* RESULTS */

.results{
  padding:60px 20px;
  max-width:900px;
  margin:auto;
}

/* STAGE LOADING OVERLAY */

.loading-overlay{
  position:fixed;
  inset:0;
  background:black;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  z-index:9999;
  opacity:0;
  pointer-events:none;
  transition:.4s ease;
}

.loading-overlay.active{
  opacity:1;
  pointer-events:auto;
}

/* Flashing stage lights */

.loading-overlay::before,
.loading-overlay::after{
  content:"";
  position:absolute;
  width:200%;
  height:200%;
  background:radial-gradient(circle at top, rgba(249,69,1,.25), transparent 60%);
  animation:lights 1.5s infinite alternate;
}

@keyframes lights{
  0%{opacity:.3}
  100%{opacity:.8}
}

.stage-icons{
  font-size:70px;
  display:flex;
  gap:40px;
  animation:rock 1.2s infinite alternate;
}

@keyframes rock{
  0%{transform:scale(1) rotate(-5deg)}
  100%{transform:scale(1.1) rotate(5deg)}
}

.quote{
  margin-top:40px;
  text-align:center;
  max-width:600px;
}

.quote .text{
  font-family:'Poppins';
  font-size:24px;
  margin-bottom:10px;
}

.quote .artist{
  opacity:.7;
}

</style>
</head>

<body>

<div class="hero">
  <div class="hero-content">
    <h1>Find venues that want to see you play.</h1>
    <div class="sub">Book more shows. Play more music.</div>

    <div class="search-box">

      <div class="segment" id="showTypeSegment">
        <div class="segment-option active">Single show</div>
        <div class="segment-option">Multi-city</div>
      </div>

      <label id="cityLabel">City</label>
      <input id="cityInput" placeholder="Nashville">

      <label>Genre</label>
      <div class="row">
        <div class="pill">ðŸŽ¸ Rock</div>
        <div class="pill">ðŸŒ™ Indie</div>
        <div class="pill">ðŸŽ· Jazz</div>
        <div class="pill">ðŸŽ­ Cabaret</div>
        <div class="pill">ðŸŽ¤ Comedy</div>
      </div>

      <label>Audience size</label>
      <input id="audienceInput" placeholder="20-30">

      <button class="search-btn" id="searchBtn">Search venues</button>

    </div>
  </div>
</div>

<div class="results" id="results"></div>

<div class="loading-overlay" id="loadingOverlay">
  <div class="stage-icons">
    ðŸŽ¸ ðŸŽ¤
  </div>
  <div class="quote" id="quoteBox"></div>
</div>

<script>

const quotes=[
  {text:"Don't stop believin'.",artist:"Journey"},
  {text:"The show must go on.",artist:"Queen"},
  {text:"You have to fight to reach your dream.",artist:"Bad Bunny"},
  {text:"Dream until your dreams come true.",artist:"Aerosmith"},
  {text:"Started from the bottom now we here.",artist:"Drake"},
  {text:"No one can make you feel inferior.",artist:"Aretha Franklin"}
];

function showQuote(){
  const q=quotes[Math.floor(Math.random()*quotes.length)];
  document.getElementById("quoteBox").innerHTML=
  `<div class="text">"${q.text}"</div>
   <div class="artist">â€” ${q.artist}</div>`;
}

document.querySelectorAll(".pill").forEach(p=>{
  p.addEventListener("click",()=>p.classList.toggle("active"));
});

let showType="Single show";

document.querySelectorAll(".segment-option").forEach(btn=>{
  btn.addEventListener("click",function(){
    document.querySelectorAll(".segment-option").forEach(b=>b.classList.remove("active"));
    this.classList.add("active");
    showType=this.innerText;

    if(showType==="Single show"){
      confetti({
        particleCount:150,
        spread:80,
        origin:{y:0.6},
        shapes:['text'],
        shapeOptions:{text:{value:'ðŸŽ¤',font:'30px serif'}}
      });
    }else{
      confetti({particleCount:160,spread:100,origin:{y:0.6}});
    }
  });
});

searchBtn.addEventListener("click",async function(){

  const city=cityInput.value;
  const audience=audienceInput.value;
  if(!city) return;

  const overlay=document.getElementById("loadingOverlay");
  overlay.classList.add("active");
  showQuote();

  try{
    const res=await fetch("/api/search",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({city,audience})
    });

    const data=await res.json();
    document.getElementById("results").innerHTML="";

    data.forEach(v=>{
      const div=document.createElement("div");
      div.style.padding="10px 0";
      div.innerText=v.name;
      document.getElementById("results").appendChild(div);
    });

  }catch(err){
    console.error(err);
  }

  overlay.classList.remove("active");
});

</script>

</body>
</html>
